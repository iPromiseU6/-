<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="../../Themes/material/easyui.css">
    <link rel="stylesheet" type="text/css" href="../../Themes/icon.css">
    <link rel="stylesheet" type="text/css" href="../../CSS/common.css">
</head>
<body style="padding: 0px;">
<div id="div_layout" class="easyui-layout">
    <div id="div_search" data-options="region:'north'">
    </div>
    <div data-options="region:'center'">
        <div class="easyui-panel" title="数据列表">
            <table id="dg">
            </table>
        </div>
    </div>
</div>
<div id="toolbar"></div>
<div id="dlg" class="easyui-dialog" closed="true">
    <iframe id="ifrmEdit" height="100%" width="100%" frameborder="0" scrolling="no"></iframe>
</div>
<script type="text/javascript" src="../../JS/jquery.min.js"></script>
<script type="text/javascript" src="../../JS/jquery.easyui.js"></script>
<script type="text/javascript" src="../../JS/common.js"></script>
<script type="text/javascript" src="../../Utils/ip.js"></script>
<script type="text/javascript" src="../../Utils/ShareComponent.js"></script>
<script type="text/javascript" src="../../JS/ToolBar.js"></script>
<script type="text/javascript" src="../../JS/SearchComponent.js"></script>
<script type="text/javascript" src="../../Utils/BasicList.js"></script>
<script type="text/javascript" src="../../Utils/Request.js"></script>
<script type="text/javascript" src="../../Utils/Enum.js"></script>
<script type="text/javascript" src="../Transaction/ReceiptDetailCommon.js"></script>
<script>
    var gBasicList = new BasicListPage();
    var gRequest = new RequestHandle();
    var gApiKey = "REPORT";
    var gSearchOptions = SEARCH_REPORT_DATE_START+SEARCH_REPORT_DATE_END;
    gBasicList.createSearch(gSearchOptions);


    var gToolbarOptions = DATAGRID_TOOLBAR_ADD;
    gToolbarOptions += DATAGRID_TOOLBAR_EDITOR;
    gToolbarOptions += DATAGRID_TOOLBAR_DELETE;
    gBasicList.createToolbar(gToolbarOptions);

    var gDatagridUrl = RequestUrl.constructURL(gApiKey, "list");
    var gConfig = {
        url : gDatagridUrl,
        method : "put",
        columns :  [
        [{
            field: 'ck',
            checkbox: 'true',
        },{
            field : 'id',
            title : 'id',
            width : '10%',
            align : 'center'
        }, {
            field : 'submissionDate',
            title : 'submissionDate',
            width : '15%',
            align : 'center',
        }, {
            field : 'reportCode',
            title : 'reportCode',
            width : '15%',
            align : 'center',
        }, {
            field : 'submissionCode',
            title : 'submissionCode',
            width : '25%',
            align : 'center'
        },]
    ],
        onDblClickRow : function (index, row) {
            var pLocation = "UI/ReportSubmit/ReportSubmitDetail.html?id=" + row.id;
            AddTabIn("Report Submit Detail", parent.$('#tabs'), pLocation);
        },
    };
    gBasicList.createDataGrid(gConfig);
    $(document).ready(function () {
        getNameData();
    });


    //获取下拉框中的名字信息
    function getNameData() {
        var _sendData = {status : 0};
        gRequest.putRemoteData(gApiKey, "list", _sendData).done(function (_result) {
            if (_result.code === 0) {
                nameData = _result.data.data;
                $("#search_receipt_firstName").combobox({
                    data : nameData,
                });
            }
        });
    }

    function doSearch() {
        var _searchCondition = processSearchConditionObject();
        if (_searchCondition.createTimeStart) {
            _searchCondition.createTimeStart = new Date(_searchCondition.createTimeStart).format("yyyy-MM-dd hh:mm:ss");
        }
        if (_searchCondition.createTimeEnd) {
            _searchCondition.createTimeEnd = new Date(_searchCondition.createTimeEnd).format("yyyy-MM-dd hh:mm:ss");
        }
        gRequest.putRemoteData(gApiKey, "list", _searchCondition).done(function (result) {
            if (result.code === 0) {
                $("#dg").datagrid('loadData', result.data.data);
            } else {
                $.messager.alert("Fail", result.msg);
            }
        });
    }

    function doReset() {
        $(".easyui-combobox").each(function (index) {
            $(this).combobox('clear');
        });
        $(".easyui-datebox").each(function (index) {
            $(this).combobox('clear');
        });
    }


    function destroy() {
        var _row = $('#dg').datagrid('getSelected');
        if (!_row) {
            $.messager.alert('Info', "Please select the data you want to delete");
            return;
        }
        var _sendData = {id : _row.id};
        $.messager.confirm("Alert", "are you sure delete this record?", function (r) {
            if (r) {
                gRequest.delRemoteData(gApiKey, "del", JSON.stringify(_sendData)).done(function (result) {
                    if (result.code === 0) {
                        $.messager.alert("Alert", "delete success!");
                        gBasicList.resetHandle(gApiKey);
                    } else {
                        $.messager.alert("Alert", result.msg);
                    }
                });
            }
        });
    }

    function newData() {
        var _pLocation = "UI/ReportSubmit/ReportSubmitDetail.html?id=-1";
        AddTabIn("Report Submit Detail", parent.$('#tabs'), _pLocation);
    }

    function editData() {
        var _row = $('#dg').datagrid('getSelected');
        if (!_row) {
            $.messager.alert('Info', "Please select the data you want to update");
            return;
        }
        var id = _row.id;
        var _pLocation = "UI/ReportSubmit/ReportSubmitDetail.html?id=" + id;
        AddTabIn("Report Submit Detail", parent.$('#tabs'), _pLocation);
    }
</script>
</body>
</html>
