<!--创建人：lhf-->
<!--创建时间：2018.1.3-->
<!--描述：Report页-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="../../Themes/material/easyui.css">
    <link rel="stylesheet" type="text/css" href="../../Themes/icon.css">
    <link rel="stylesheet" type="text/css" href="../../CSS/common.css">
</head>
<body style="padding: 0px;">
<div id="div_layout" class="easyui-layout">
    <div id="div_search" data-options="region:'north'" style="height: 240px;">
    </div>
    <div data-options="region:'center'">
        <div class="easyui-panel" title="Data List">
            <table id="dg">
            </table>
        </div>
    </div>
</div>
<div id="toolbar"></div>
<div id="dlg" class="easyui-dialog" closed="true">
    <iframe id="ifrmEdit" height="100%" width="100%" frameborder="0" scrolling="no"></iframe>
</div>
<script type="text/javascript" src="../../JS/jquery.min.js"></script>
<script type="text/javascript" src="../../JS/jquery.easyui.js"></script>
<script type="text/javascript" src="../../JS/common.js"></script>
<script type="text/javascript" src="../../Utils/ip.js"></script>
<script type="text/javascript" src="../../Utils/ShareComponent.js"></script>
<script type="text/javascript" src="../../JS/ToolBar.js"></script>
<script type="text/javascript" src="../../JS/SearchComponent.js"></script>
<script type="text/javascript" src="../../Utils/BasicList.js"></script>
<script type="text/javascript" src="../../Utils/Request.js"></script>
<script type="text/javascript" src="../../Utils/Enum.js"></script>
<script>
    var gBasicList = new BasicListPage();
    var gRequest = new RequestHandle();
    var gApiKey= "DEAL";
    var gSearchOptions = SEARCH_RECEIPT_CREATETIME_START;
    gSearchOptions += SEARCH_RECEIPT_CREATETIME_END;
    gSearchOptions += SEARCH_TRANSACTION_CURRENCYCODE_TO;
    gSearchOptions += SEARCH_TRANSACTION_CURRENCYCODE_FROM;
    gSearchOptions += SEARCH_TRANSACTION_AMOUNTMAX;
    gSearchOptions += SEARCH_TRANSACTION_AMOUNTMIN;
    gSearchOptions += SEARCH_TRANSACTION_CREATEUSER;
    gBasicList.createSearch(gSearchOptions);//创建搜索界面

    gRequest.postRemoteData("USER","listbrif",JSON.stringify({})).done(function (result) {
        if(result.code === 0){
            nameData = result.data.data;
            $("#search_transaction_createUser").combobox({
                data:nameData,
            })
        }
    });
    $("#div_search").append('<div class="div_search_content"style="margin-left:2%;margin-top:40px">GroupBy&nbsp</div>\n'+
        '<div id="div_search_content" style="width: 100%;margin-top:20px">\n' +
        '<form style="height:20px;padding-left: 6%;width: 100%" id="checkbox_ff">\n' +
        '</form></div>');
    $("#checkbox_ff").append('<input type="checkbox" name="GroupBy" checked=true value="byCustomerId" style="width: 4%"><span>byCustomerId</span>')
    $("#checkbox_ff").append('<input type="checkbox" name="GroupBy" checked=true value="byFromCurrencyCode" style="width: 4%"><span>byFromCurrencyCode</span>')
    $("#checkbox_ff").append('<input type="checkbox" name="GroupBy" checked=true value="byToCurrencyCode" style="width: 4%"><span>byToCurrencyCode</span>')
    $("#checkbox_ff").append('<input type="checkbox" name="GroupBy" value="tripartiteTransaction" style="width: 4%"><span>tripartiteTransaction</span>')
    var gDatagridUrl = RequestUrl.constructURL(gApiKey, "sum");
    var gConfig = {
        url : gDatagridUrl,
        method:"put",
        queryParams:{},
        columns : [
            [{
                field : 'firstName',
                title : 'First Name',
                width : '10%',
                align : 'center',
            },{
                field : 'lastName',
                title : 'Last Name',
                width : '10%',
                align : 'center',
            },{
                field : 'middleName',
                title : 'Middle Name',
                width : '10%',
                align : 'center',
            },{
                field : 'amountLocalSum',
                title : 'AmountLocalSum',
                width : '12%',
                align : 'center',
            },{
                field : 'fromAmountSum',
                title : 'FromAmountSum',
                width : '12%',
                align : 'center',
            },{
                field : 'toAmountSum',
                title : 'ToAmountSum',
                width : '12%',
                align : 'center',
            },{
                field : 'fromCurrencyCode',
                title : 'FromCurrencyCode     ',
                width : '12%',
                align : 'center',
            },{
                field : 'toCurrencyCode',
                title : 'ToCurrencyCode     ',
                width : '12%',
                align : 'center',
            }]
        ]
    }
    gBasicList.createDataGrid(gConfig);

    function getData(){
        gRequest.putRemoteData(gApiKey,"sum",{}).done(function(result){

        })
    }
    function doSearch(){
        var _searchCondition = processSearchConditionObject(),
            _sendData = {},
            _dataArr = {},
            temp = '',
            tempArr = [];
        var GroupBy = document.forms[0].GroupBy;

        for (var i=0;i<GroupBy.length;i++)
        {
            if (GroupBy[i].checked)
            {
                _dataArr[GroupBy[i].value] = true;
                // _dataArr.push();
            }
        }

        if(_searchCondition.startTime) {
            tempArr = _searchCondition.startTime.split("-");
            tempArr.unshift(tempArr.pop());
            temp = tempArr.join("-");
            _sendData.createTimeStart = temp+" 00:00:00";
        }
        if(_searchCondition.endTime) {
            tempArr = _searchCondition.endTime.split("-");
            tempArr.unshift(tempArr.pop());
            temp = tempArr.join("-");
            _sendData.createTimeEnd = temp+" 00:00:00";
        }
        delete _searchCondition.GroupBy;
        _sendData = $.extend(false,_sendData,_searchCondition);
        _sendData = $.extend(false,_sendData,_dataArr);
        if(!_sendData.byCustomerId){
            _sendData.byCustomerId = false;
        }
        if(!_sendData.byFromCurrencyCode){
            _sendData.byFromCurrencyCode = false;
        }
        if(!_sendData.byToCurrencyCode){
            _sendData.byToCurrencyCode = false;
        }
        gRequest.putRemoteData(gApiKey,"sum",_sendData).done(function (result) {
            if(result.code===0){
                $("#dg").datagrid('loadData',result.data.data)
            }
            else{
                $.messager.alert("Fail", result.msg);
            }
        })
    }
    function doReset() {
        $(".easyui-combobox").each(function (index) {
            $(this).combobox('clear');
        });
        $(".easyui-datebox").each(function(index){
            $(this).combobox('clear');
        })
        $(".easyui-textbox").each(function(index){
            $(this).textbox('clear');
        })
        var GroupBy = document.forms[0].GroupBy;
        for (var i=0;i<GroupBy.length;i++)
        {
            GroupBy[i].checked = false;
        }
    }
</script>
</body>
</html>